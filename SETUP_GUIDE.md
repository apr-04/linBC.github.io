# 명함 신청 관리 시스템 - 상세 설정 가이드

이 문서는 명함 신청 관리 시스템을 처음부터 설정하는 단계별 가이드를 제공합니다.

## 사전 준비사항

- Google 계정 (Gmail 또는 Google Workspace)
- Google Sheets 접근 권한
- Google Drive 접근 권한

## 1단계: Google Sheets 생성 및 설정

### 1.1 새 Google Sheets 파일 생성

1. [Google Sheets](https://sheets.google.com) 접속
2. **빈 스프레드시트** 클릭하여 새 파일 생성
3. 파일 이름을 "명함 신청 관리 DB"로 변경

### 1.2 시트 설정

1. 하단의 "시트1" 탭을 우클릭
2. **이름 변경** 클릭
3. "신청목록"으로 변경

### 1.3 헤더 행 설정

A1부터 M1까지 다음 헤더를 입력:

```
A1: 신청ID
B1: Status
C1: 신청자계정
D1: 등록자
E1: 통
F1: 기존동일여부
G1: 변호사여부
H1: 담당변호사
I1: 비고
J1: 등록일
K1: 첨부파일
L1: 처리자
M1: 처리일자
```

4. 첫 번째 행을 선택하고 **서식 > 텍스트 굵게** 적용

## 2단계: Google Apps Script 프로젝트 생성

### 2.1 Apps Script 편집기 열기

1. Google Sheets에서 **확장 프로그램 > Apps Script** 클릭
2. 새 브라우저 탭에서 Apps Script 편집기가 열림

### 2.2 파일 구조 생성

Apps Script 편집기에서 다음 파일들을 생성:

#### Code.gs 파일
1. 왼쪽 파일 목록에서 `Code.gs` 클릭
2. 기존 내용을 모두 삭제
3. 제공된 `Code.gs` 파일 내용을 복사하여 붙여넣기

#### HTML 파일 생성

각 HTML 파일을 생성하려면:

1. **파일 > 새로 만들기 > HTML 파일** 클릭
2. 파일 이름 입력 (예: `UserForm`)
3. 제공된 HTML 내용을 복사하여 붙여넣기
4. **파일 > 저장** 클릭

생성해야 할 HTML 파일:
- `UserForm.html` - 명함 신청 폼
- `CheckStatus.html` - 신청 내역 조회
- `ReviewDraft.html` - 초안 확인 페이지
- `AdminPage.html` - 관리자 페이지

### 2.3 설정 값 수정

`Code.gs` 파일 상단의 `CONFIG` 객체를 찾아 수정:

```javascript
const CONFIG = {
  SHEET_NAME: '신청목록',  // 시트 이름 (정확히 일치해야 함)
  ADMIN_EMAIL: 'bysong@law-lin.com',  // 관리자 이메일 주소
  ADMIN_PASSWORD: 'admin123',  // ⚠️ 반드시 강력한 비밀번호로 변경!
  DRIVE_FOLDER_NAME: '명함 초안 파일'  // Google Drive 폴더 이름
};
```

**중요**: `ADMIN_PASSWORD`는 반드시 강력한 비밀번호로 변경하세요!

## 3단계: Google Drive 폴더 생성

1. [Google Drive](https://drive.google.com) 접속
2. **새로 만들기 > 폴더** 클릭
3. 폴더 이름을 "명함 초안 파일"로 설정 (또는 CONFIG에서 지정한 이름)
4. 폴더 생성 완료

**참고**: 폴더는 자동으로 생성되지만, 미리 생성해두면 더 안전합니다.

## 4단계: 웹 앱 배포

### 4.1 배포 설정

1. Apps Script 편집기에서 **배포 > 새 배포** 클릭
2. **유형 선택** 옆의 설정 아이콘(⚙️) 클릭
3. **웹 앱** 선택

### 4.2 배포 옵션 설정

- **설명**: "명함 신청 관리 시스템 v1.0"
- **실행 사용자**: **나** 선택 (중요!)
- **액세스 권한**: 
  - 내부 사용: **내 조직의 사용자**
  - 외부 사용: **모든 사용자** (비공개 링크로 접근)

### 4.3 배포 실행

1. **배포** 버튼 클릭
2. 권한 검토 창이 나타나면 **권한 검토** 클릭
3. Google 계정 선택
4. **고급** 클릭
5. **안전하지 않은 페이지로 이동** 클릭
6. **허용** 클릭

### 4.4 웹 앱 URL 복사

1. 배포 완료 후 나타나는 웹 앱 URL 복사
2. 예시: `https://script.google.com/macros/s/AKfycby.../exec`
3. 이 URL을 안전한 곳에 저장

## 5단계: 테스트

### 5.1 신청 폼 테스트

1. 브라우저에서 `[웹앱URL]?page=form` 접속
2. 테스트 데이터 입력:
   - 신청자 이름: 테스트
   - 이메일: 본인 이메일
   - 통 개수: 1
   - 기존 동일 여부: 아니오
   - 신청자 구분: 변호사
3. **신청하기** 클릭
4. 신청ID 확인
5. 이메일 수신 확인

### 5.2 신청 내역 조회 테스트

1. `[웹앱URL]?page=check` 접속
2. 테스트 시 사용한 이메일과 신청ID 입력
3. **조회하기** 클릭
4. 상태 확인 (예: "신청")

### 5.3 관리자 페이지 테스트

1. `[웹앱URL]?page=admin` 접속
2. 설정한 비밀번호 입력
3. 로그인 확인
4. 신청 목록 표시 확인

### 5.4 초안 전달 테스트

1. 관리자 페이지에서 테스트 신청 내역 찾기
2. **상세** 버튼 클릭
3. **초안 파일 첨부** 클릭
4. 테스트 파일 업로드 (PDF 또는 이미지)
5. **초안 확인 요청** 버튼 클릭
6. 이메일 수신 확인
7. 이메일 링크 클릭하여 초안 확인 페이지 접근
8. 초안 파일 확인
9. **제작 신청** 또는 **추가 수정 요청** 테스트

## 6단계: 프로덕션 설정

### 6.1 보안 강화

1. **관리자 비밀번호 변경**
   - `Code.gs`의 `ADMIN_PASSWORD`를 강력한 비밀번호로 변경
   - 최소 12자 이상, 대소문자, 숫자, 특수문자 포함

2. **웹 앱 접근 권한 제한**
   - 내부 사용만 허용하는 경우 "내 조직의 사용자"로 설정
   - 외부 사용이 필요한 경우 "모든 사용자"로 설정하되 링크를 비공개로 관리

3. **이메일 주소 검증** (선택사항)
   - 특정 도메인만 허용하도록 코드 수정 가능

### 6.2 사용자 안내

다음 URL을 사용자에게 공유:

- **명함 신청**: `[웹앱URL]?page=form`
- **신청 내역 조회**: `[웹앱URL]?page=check`

관리자 페이지 URL은 비공개로 관리하세요.

## 7단계: 문제 해결

### 이메일이 발송되지 않는 경우

1. **Apps Script 실행 로그 확인**
   - Apps Script 편집기에서 **실행 > 실행 기록** 확인
   - 오류 메시지 확인

2. **이메일 주소 확인**
   - `CONFIG.ADMIN_EMAIL`이 올바른지 확인
   - Gmail 스팸 폴더 확인

3. **권한 확인**
   - MailApp 서비스 권한이 허용되었는지 확인

### 파일 업로드가 안 되는 경우

1. **파일 크기 확인**
   - Google Apps Script는 50MB 제한
   - 더 큰 파일은 Google Drive에 직접 업로드 후 링크 입력

2. **Drive 권한 확인**
   - Drive API 권한이 허용되었는지 확인
   - 폴더 생성 권한 확인

### 시트를 찾을 수 없는 경우

1. **시트 이름 확인**
   - `CONFIG.SHEET_NAME`과 실제 시트 이름이 정확히 일치하는지 확인
   - 대소문자, 공백 주의

2. **시트 존재 확인**
   - 시트가 삭제되지 않았는지 확인
   - 올바른 Google Sheets 파일에 연결되어 있는지 확인

### 웹 앱이 로드되지 않는 경우

1. **배포 버전 확인**
   - **배포 > 배포 관리**에서 최신 버전이 활성화되어 있는지 확인
   - 필요시 새 버전 배포

2. **권한 확인**
   - 웹 앱 접근 권한이 올바르게 설정되었는지 확인
   - 실행 사용자가 "나"로 설정되었는지 확인

## 8단계: 유지보수

### 정기 점검 사항

1. **신청 데이터 백업**
   - Google Sheets를 정기적으로 다운로드하여 백업
   - 또는 Google Drive에 자동 백업 설정

2. **로그 확인**
   - Apps Script 실행 기록을 정기적으로 확인
   - 오류 발생 시 즉시 대응

3. **사용자 피드백 수집**
   - 시스템 개선을 위한 피드백 수집

### 업데이트 방법

1. `Code.gs` 또는 HTML 파일 수정
2. **파일 > 저장** 클릭
3. **배포 > 배포 관리** 클릭
4. **새 버전 편집** 클릭
5. **버전 설명** 입력
6. **배포** 클릭

## 추가 기능 확장 아이디어

- 신청 내역 Excel 다운로드 기능
- 통계 대시보드 (상태별 건수, 월별 신청 현황 등)
- 이메일 템플릿 커스터마이징
- 다국어 지원
- 모바일 최적화 개선

## 지원 및 문의

시스템 관련 문의사항이나 문제가 발생하면 관리자에게 연락하세요.

